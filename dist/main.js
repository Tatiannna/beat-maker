!function(){"use strict";!function(){class t{static tracks=[];static tempo=1400;constructor(e,n){this.volume=1e3;for(let n=0;n<8;n++)t.tracks.push(new a(e));this.addNavControls(n)}addNavControls(t){const e=document.getElementById("nav-left"),n=document.createElement("button");n.textContent="Track +",e.appendChild(n);const s=document.createElement("button");s.textContent="Play",e.appendChild(s);const o=document.createElement("button");o.textContent="Tempo +",e.appendChild(o);const a=document.createElement("button");a.textContent="Tempo -",e.appendChild(a);const c=document.createElement("button");c.textContent="Volume -",e.appendChild(c);const l=document.createElement("button");l.textContent="Volume+",e.appendChild(l);const i=document.createElement("button");i.textContent="Stop",e.appendChild(i),n.addEventListener("click",(t=>{this.addTrack(container)})),s.addEventListener("click",(t=>{this.playAllTracks()})),a.addEventListener("click",(t=>{this.changeTempo(-50)})),o.addEventListener("click",(t=>{this.changeTempo(50)})),c.addEventListener("click",(t=>{this.changeVolume(-50)})),l.addEventListener("click",(t=>{this.changeVolume(50)})),i.addEventListener("click",(t=>{this.stopAllTracks()}))}addTrack(e){const n=new a(e);t.tracks.push(n)}playAllTracks(){const e=[];t.tracks.length>0?(t.tracks.forEach((t=>{e.push(new Promise(t.playTrack.bind(t)))})),console.log(e),Promise.all(e).catch((()=>console.log("Something went wrong!")))):console.log("No tracks to play!")}stopAllTracks(){const e=[],n=function(){t.tracks.forEach((t=>{t.stopped=!0}))};t.tracks.length>0?(t.tracks.forEach((t=>{e.push(new Promise(n.bind(t)))})),console.log(e),Promise.all(e).catch((()=>console.log("Something went wrong!")))):console.log("No tracks playing!")}changeTempo(e){t.tempo+=e,console.log(this.tempo)}changeVolume(t){this.volume+=t,console.log(this.volume)}}var e=t;class n{static allContexts=[];static packs=[{name:"Claps",count:7},{name:"Blast Block",count:9},{name:"Egg Shaker",count:11},{name:"Mid Tom",count:10},{name:"Percussion Kick",count:20},{name:"Percussion Snare",count:20},{name:"Percussion Hi-Hat",count:20}];constructor(t,e){this.audio=new Audio,this.audio.loop=!1,this.isAnimating=!1,this.audioSourceSet=!1}src(t,e){let n="./assets/";return n+=`${t}/${e}.wav`,n}setSound(t,e){this.audio=new Audio(this.src(t,e)),this.createContext()}createContext(){if(console.log("All sound contexts:",n.allContexts),n.allContexts.every((t=>t.src!=this.audio.src))){console.log("creating context for",this.audio.src);let t=new AudioContext,e=t.createMediaElementSource(this.audio),s=t.createAnalyser();e.connect(s),s.connect(t.destination),s.fftsize=512;let o=s.frequencyBinCount,a=new Uint8Array(o);n.allContexts.push({src:this.audio.src,freqData:a,analyser:s})}}playSound(){const t=document.getElementById("canvas"),e=t.getContext("2d");let s,o;const a=t.width/20;console.log(this.audio.play());const c=function(){const l=[],i=[];let d;if(e.clearRect(0,0,t.width,t.height),requestAnimationFrame(c),n.allContexts.forEach((t=>{d=t.freqData,t.analyser.getByteFrequencyData(d),l.push(d)})),n.allContexts.length>0)for(let t=0;t<l[0].length;t++)i.push(0),l.forEach((e=>{i[t]+=e[t]}));o=0;for(let n=0;n<40;n++)s=i[n],e.fillStyle="rgb(243, 252, 74)",e.fillRect(o,t.height-s,a,s),o+=a;console.log("Visualizer Running!")};c()}visualizeSound(){}random(){}}var s=n,o=class{constructor(t){this.track=t,this.addControls()}addControls(){const t=document.createElement("div");t.classList.add("track-div-left"),this.track.trackDiv.appendChild(t);let e=document.createElement("button");e.textContent="Remove",t.appendChild(e);let n=document.createElement("button");n.textContent="Stop",t.appendChild(n),this.addControlListeners(e);const o=document.createElement("button");o.textContent="Test",t.appendChild(o),o.addEventListener("click",(t=>{this.track.sound.playSound()}));const a=document.createElement("button");a.textContent="Play",t.appendChild(a),a.addEventListener("click",(t=>{this.track.playTrack()}));let c=document.createElement("select"),l=document.createElement("option");l.textContent="Select Sound Pack",l.setAttribute("selected",!0),l.setAttribute("disabled",!0),c.appendChild(l);for(let t=0;t<s.packs.length;t++){let e=document.createElement("option");e.textContent=s.packs[t].name,e.value=s.packs[t].name,c.appendChild(e)}t.appendChild(c);let i=document.createElement("select");l=document.createElement("option"),l.textContent="Select Sound",l.setAttribute("selected",!0),l.setAttribute("disabled",!0),i.appendChild(l),t.appendChild(i);let d=null;c.addEventListener("change",(t=>{let e,n;d=t.srcElement.value,console.log(d);for(let t=0;t<s.packs.length;t++)d===s.packs[t].name&&(n=t,e=s.packs[t].count);i.replaceChildren(),l=document.createElement("option"),l.textContent="Select Sound",l.setAttribute("selected",!0),l.setAttribute("disabled",!0),i.appendChild(l);for(let t=0;t<e;t++){let e=document.createElement("option");e.textContent=`${s.packs[n].name} ${t}`,e.value=`${t}`,i.appendChild(e)}})),n.addEventListener("click",(t=>{this.track.stopped=!0}));let r=null;i.addEventListener("change",(t=>{r=t.srcElement.value,console.log(r),this.track.sound.setSound(d,r),this.track.sound.playSound()}))}addControlListeners(t){t.addEventListener("click",(t=>{let n=e.tracks.indexOf(this.track);console.log("index to remove: ",n),e.tracks.splice(n,1),this.track.trackDiv.remove()}))}},a=class{constructor(t){this.segments=[],this.trackDiv=null,this.sound=new s,this.buildTrack(t),this.stopped=!1,this.loop=!0}buildTrack(t){this.trackDiv=document.createElement("div"),this.trackDiv.classList.add("track"),t.appendChild(this.trackDiv),new o(this);const e=document.createElement("div");e.classList.add("track-div-right"),this.trackDiv.appendChild(e);let n=document.createElement("ul");for(let t=0;t<8;t++){let e=document.createElement("li");e.classList.add("segment"),e.classList.add("off"),e.dataset.pos=`${t}`,this.segments.push(e),n.appendChild(e)}e.appendChild(n),this.addSegmentListner(n)}addSegmentListner(t){t.addEventListener("click",(t=>{"segment"==t.srcElement.classList[0]&&("off"===t.srcElement.classList[1]?(t.target.classList.remove("off"),t.target.classList.add("on")):(t.target.classList.remove("on"),t.target.classList.add("off")))}))}addSegmentListner(t){t.addEventListener("click",(t=>{"segment"==t.srcElement.classList[0]&&("off"===t.srcElement.classList[1]?(t.target.classList.remove("off"),t.target.classList.add("on")):(t.target.classList.remove("on"),t.target.classList.add("off")))}))}playTrack(){let t=0,n=2e3-e.tempo;function s(t){t.classList.remove("playing")}const o=setInterval(function(){if(8===t&&!1===this.loop||!0===this.stopped)return clearInterval(o),void(this.stopped=!1);this.segments[t].classList.add("playing"),"on"===this.segments[t].classList[1]?(this.sound.playSound(),console.log(`Playing sound for segment ${t+1}`)):console.log(`NO SOUND for segment ${t+1}`),setTimeout(s.bind(this,this.segments[t]),n),console.log("After playing: ",this.segments[t].classList),t+=1,8===t&&!0===this.loop&&(t=0)}.bind(this),n)}};const c=document.getElementById("container");document.getElementById("nav"),new e(c,nav)}()}();
//# sourceMappingURL=main.js.map